<html>
   <link rel="icon" href="https://disandy.hn/wp-content/uploads/2022/06/poire.jpeg">
    <title>Text Dwnl</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    
<style>
body{background:white;text-align:center;}
textarea{
    width:90%;
    height:25%;
    margin:10px;
}
button{
    margin:10px;
}

</style>
<br><br>
<input id="pass"><input type="number" id="pinn" value=0><br><br>
original <textarea id="o"></textarea>
<br>
<button onclick="codif()">Codificar</button>
<button onclick="decodif()">Decodificar</button>
<button onclick="simplify()">Simplify</button>

<br>
Codificado <textarea id="c"></textarea>
<button onclick="c.select();document.execCommand('copy');alert('copied to Clipboard')">Copy</button>
<input id="ilink" value="https://jsonblob.com/api/1104605050826932224"></input>
<button onclick="sendTo()">Send To</button>
<script>
function codif(){
  cod(pass.value,o.value,function(res){
      c.value=res;
      },pinn.value);
}

function decodif(){
      decod(pass.value,c.value,function(res){
          o.value=res;
          },pinn.value);
}

linke = "https://jsonblob.com/api/880532582229516288"; //para fechas en comun
linkreg='http://jsonblob.com/api/882342004131049472'; //regresadas y pending
linktemp='http://jsonblob.com/api/882342506029854720'; //apoyo

mcl = "CoMaNdO_0118";
ac = 'andres,pablo,melvin,dany,lauro';
ac = ac.split(',');
decod = function(clv, r,callback,pin) {
    if(pin===undefined) pin=0;
        pin=pin*1;  
    var s = "";
    for (var i = 0; i < r.length; i++) {
        i--;
        for (var ii = 0; ii < clv.length; ii++) {
            i++;
            var n1 = r.charCodeAt(i);
            var n = n1 - clv.charCodeAt(ii)-pin;
            s += String.fromCharCode(n);
            if (i === r.length - 1) {
                ii = clv.length;
                i = r.length;
            }
        }
    }
    if(callback!=undefined) callback(s);
    return s;
}

function cod(clv, r,callback,pin) {
   
       if(pin===undefined) pin=0;
       pin=pin*1;
    var s = "";
    for (var i = 0; i < r.length; i++) {
        var n = 0;
        i--;
        for (var ii = 0; ii < clv.length; ii++) {
            i++;
            n = r.charCodeAt(i);
            n = n + clv.charCodeAt(ii)+pin;
            s += String.fromCharCode(n);
            if (i === r.length - 1) {
                ii = clv.length;
                i = r.length;
            }
        }
    }
    if(callback!=undefined) callback(s);
    return s;
}
function simplify(tx){
    
    c.value=o.value.replace(/\n/g,"");


}
function sendTo(){
    if(ilink.value!=""){
        var ob={};
        ob.txt=c.value;
        UpdateJ(ilink.value,ob,function(){alert("text sent")})
        
    }
    
}

function GetJ(url, callback) {

            //var url  = "http://localhost:8080/api/v1/users";
            var xhr = new XMLHttpRequest()
            xhr.open('GET', url + '/1', true)
            xhr.onload = function() {
                //         (xhr.responseText)
                var users = JSON.parse(xhr.responseText);
                //     var obb=decoding(users.prim);

                if (xhr.readyState == 4 && xhr.status == "200") {
                    callback(users);
                } else {
                    console.error(users);
                }
            }
            xhr.send(null);
        }

         // Update a user
        function UpdateJ(url, ob, callback) {

            json = JSON.stringify(ob);
            var xhr = new XMLHttpRequest();
            xhr.open("PUT", url + '/12', true);
            xhr.setRequestHeader('Content-type', 'application/json; charset=utf-8');
            xhr.onload = function() {
                var users = JSON.parse(xhr.responseText);
                if (xhr.readyState == 4 && xhr.status == "200") {
                    //  alert("Tu Forma ha sido Enviada");
                    if (callback != undefined) callback(users);
                } else {
                    (users);
                }
            }
            xhr.send(json);
        }


//http://jsonblob.com/891773872484139008
</script>

</html>
